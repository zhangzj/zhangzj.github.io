---
layout: post
title: "JavaScript权威指南 读书笔记-C"
categories: javascript
description: JavaScript权威指南读书笔记
tags: javascript
---

* content
{:toc}

全书的第一编：JavaScript语言核心

第6章：对象




### 6 对象

- 对象是原始类型，可以看成是字符串到值的映射

- 除了可以包邮自身属性，还可以从一个叫原型的对象继承属性

- 除了字符串，数字，true，false，null和undefined之外，js中的值都是对象

- 对象的常见用法：创建，设置，查找，删除，检测，枚举

- 什么是属性？属性包括名字和值，一个对象里不可以重名，每个属性还有一些另外的特性

	- 可写，表明属性是不是可以设置该属性的值
	- 可枚举，是否可以通过for/in循环返回该属性
	- 可配置，是否可以删除或者修改该属性

- 每个对象还有三个相关的对象特性

	- 对象的原型，指向另外一个对象，属性继承自他的原型对象
	- 对象的类，是一个标识对象类型的字符串
	- 对象的扩展标记，说明是不是可以对该对象添加新的属性

- 术语：对三类对象和两类属性做出区分

	- 内置对象，js内的数组，函数，日期，正则等等
	- 宿主对象，js所嵌入的宿主环境，比如web浏览器，可以看做是内置对象
	- 自定义对象，运行中js代码创建的对象
	- 自有属性，直接在对象中定义的属性
	- 继承属性，在对象原型对象中定义的属性

#### 6.1 创建对象

- 创建方式有直接量创建，关键字new和Object.create()函数创建

##### 6.1.1 对象直接量

- 属性名可以是直接量，也可以是变量，值也是相同

```
var empty = {};
var point = { x : 0, y : 0 };
var point2 = { x : point.x, y : point.y+1 };
```

##### 6.1.2 通过 new 创建对象

- new运算符创建并初始化一个新对象，new 后面跟的是一个构造函数

##### 6.1.3 原型

- 除了null之外，所有的对象都是从原型继承属性

- 原型链也就是属性继承链

##### 6.1.4 Object.create()

- 这是一个静态函数，不是给某个对象调用的方法，使用的话只要传入原型对象就好

```
var o1 = Object.create({ x:1, y:2 });
```

- 传入原型的意思是

```
var o2 Object.create(Object.prototype);
```

#### 6.2 属性的查询和设置

- 之前就知道，可以使用点和方括号，引用和设置属性

##### 6.2.1 作为关联数组的对象

- 属性的访问方式

```
object.property
object["property"]
```

- js是弱类型的，属性本身是可以增减修改的，不必提前定义好，方括号引用，数组方式获取属性的好处

```
var addr = "";
for( i = 0; i < 4; i++) {
	add += customer["address" + i] + '\n';
}
```

	属性名在运行时候自动确定，很动态

##### 6.2.2 继承

- 属性的被获取的时候回在继承链上进行查找，找到或者返回null为止

- 属性的赋值，要是自己有，就会赋值，没有就会创建新的属性，不会修改原型链

##### 6.2.3 属性访问错误

- 属性不存在的时候，返回undefined，不会报错

- 对象不存在，查询这个对象的属性就会报错

#### 6.3 删除属性

- delete删除属性，是断开属性和对象的联系，不会操作属性中的属性

- 只能删除自由属性，不能删除继承属性

- delete没有任何副作用，没成功删除的话也没什么反应

#### 6.4 检测属性

- 可以用 in 运算符，hasOwnProperty()和propertyIsEnumerable()来判断

- 可以判断查询返回是不是undefined来判断

```
o.x !== undefined
```

- 但是，in 运算符可以区分是属性不存在还是存在但是没有初始化

#### 6.5 枚举属性

- 代码中给对象添加的属性都是可枚举的

#### 6.6 属性getter和setter

- 属性值可以使用连个方法替代，就是getter 和 setter ，定义的属性叫做存取器属性，跟数据属性不同

- 可以只定义 setter 或者 getter 这样子就会变成只读和只写

```
var o = {
	// data prop
	data_prop: value,

	// accessor prop
	get accessor_prop() {/* code */},
	set accessor_prop(value) {/* code */}
};
```
- 查询存取器属性的方式和数据属性一样

#### 6.7 属性的特性

- 属性的特性，配置，可写，可枚举，可配置

	- 可以给原型对象添加方法，设置成不可枚举，看起来更像内置方法
	- 给对象定义不能修改汇总和删除，锁定对象

- 可以认为数据属性，包含4个特性，分别是，值，可写性，可枚举性，可配置性

- 存取器属性就没有值和可写性，可写与否由setter决定：所以存取器属性的4个特性是，读取，写入，可枚举和可配置

- 属性描述符对象，这个对象的属性和所描述的属性的特性名字一样，有，vlaue，writable，enumerable，configurable

- 存取器属性的描述符对象使用get属性和set属性代替，writable和value，set和get都输函数值

```
Object.getOwnPropertyDescriptor({x:3333},"x");
=> Object {value: 3333, writable: true, enumerable: true, configurable: true}
```

#### 6.8 对象的三个属性

- 每一个对象都有三个属性，相关原型，prototype，类，class，可扩展性，extensible attribute

##### 6.8.1 原型属性

- 对象的原型属性是用来继承属性的

##### 6.8.2 类属性

- 类属性是一个字符串，表示对象的类型信息

##### 6.8.3 可扩展性

- 表示是不是可以给对象添加新属性

#### 6.9 序列化对象

- 将对象转化成字符串，也是将字符串转化成对象，内置函数JSON.stringfy()和JSON.parse()来序列化和还原对象

#### 6.10 对象方法

- 从原型继承的属性，也继承额方法，对象的方法

##### 6.10.1 toString() 方法

- 转化成字符串呗

##### 6.10.2 toLocalString() 方法

- 一般是调用toString，但是比如日期和数字时间等会有定制，数组调用的话，对应元素会调用自己的toLocalString

##### 6.10.3 toJSON() 方法

##### 6.10.4 valueOf() 方法

- 和toString很相似，但是是js需要将对象转换成原始值而不是字符串的时候用